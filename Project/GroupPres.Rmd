---
title: "Group 1"
author: "Austin Halvorsen, Chase Harward, Suneet Dash"
date: "12/8/2020"
output:
  revealjs::revealjs_presentation:
    theme: blood
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(wooldridge)
library(car)
library(effects)
library(corrgram)
library(wooldridge)
library(lmtest)
library(corrplot)
library(stargazer)
```

```{r data, include=FALSE}
df <- wooldridge::sleep75
df <- df[complete.cases(df),]
df <- select(df, -c(case, leis1, leis2, leis3, lhrwage, lothinc, rlxall, south, union, yngkid))
df <- df %>% mutate(sleep_h = sleep/60)

# Dataframe of only the variables we are using in the regression for the slide
model_df <- select(df, c(sleep_h, age, exper, hrwage, yrsmarr, spsepay, male, gdhlth, totwrk, marr))
model <- lm(sleep_h~hrwage+exper+age+yrsmarr+spsepay+male+gdhlth+totwrk+marr, df)
```


# Introduction {data-transition="slide-in fade-out"}

__How does someone's hourly wage impact the amount of sleep that they get on a given night?__

<section style="text-align: left;">

- Determining what role hourly wage plays in sleep is important because it can help us to understand an aspect of sleep that isn’t explored as often as opposed to just looking at hours of work itself. 

- Through this question we can even see how different income classes sleep, such as how many hours does someone in the top income percentile sleep as opposed to someone in the middle class or someone making minimum wage.

</section>

# Data {data-transition="slide-in fade-out"}

- <small>We will be using the dataset “sleep75” found in the Wooldridge package and originally used for the paper “Sleep and the Allocation of Time” by Jeff Biddle and Daniel Hamermesh, published in the Journal of Political Economy in 1998.</small>

- <small>The goal of the original paper was to show a relationship between an increase in time in the labor market and how much sleep someone gets.</small>
<<<<<<< HEAD

- <small>This data set includes 706 observations on 34 variables, notably hourly wage, sleep, years of experience, marital status, spouse wage, age, children or no children, type of employment, and quality of health.</small>

## Variables

Our variables in our model are:

<section style="text-align: left;">

- age            
- exper           
- lhrwage
- yrsmarr         
- spsepay        
- male         
- gdhlth

</section>

## Summary Stats 

```{r summary, echo=FALSE, comment=NA}
(summary(model_df))
```



# Emperical Framework {data-transition="slide-in fade-out"}

```{r}
summary(wooldridge::sleep75)
```


- <small>This data set includes 706 observations on 34 variables, notably hourly wage, sleep, years of experience, marital status, spouse wage, age, children or no children, type of employment, and quality of health.</small>

## Variables

Our variables in our model are:

<section style="text-align: left;">

- age            
- exper           
- lhrwage
- yrsmarr         
- spsepay        
- male         
- gdhlth

</section>

## Summary Stats 

```{r echo=FALSE, comment=NA}
(summary(model_df))
```

## Classical Linear Model (CLM) Assumptions

1. MLR.1 Linear in Parameters
2. MLR.2 Random Sampling
3. MLR.3 No Perfect Collinearity
4. MLR.4 Zero Conditional Mean
5. MLR.5 Homoskedasticity
6. MLR.6 Normality

## MLR.1 Linear in Parameters

The model in the population can be written as:

$sleep_h = B_0 + B_1 hrwage + B_2 exper + B_3 age + B_4 yrsmarry + B_5 spsepay + B_6 male + B_7 gdhlth + B_8 totwrk + B_9 marry + u$

- All of our parameters are linear

## MLR.2 Random Sampling

- Data is taken from wooldridge dataset sleep75, which was randomly sampled with a sample size of 706.

## MLR.3 No Perfect Collinearity

```{r echo=FALSE, comment=NA}
M <- cor(model_df)
corrplot(M, type="lower")
```
-No evidence of perfect collinearity
-Nothing is perfectly correlated with our dependent variable "sleep"
-No independent variable is constant.

## MLR.4 Zero Conditional Mean

$E(u|x_1,x_2,...,x_k) = 0$
- We included multiple important variables in order to avoid violating the Zero Conditional Mean Assumption.

## MLR.5 Homoskedasticity

$Var(u|x_1,...,x_k) = \sigma^2$
```{r echo=FALSE, comment=NA}
#Breusch-Pagan test
bptest(model)
```
- We can prove that the error has the same variance across all values of the explanatory variables
- According to the results of our Breusch-Pagan test, we have a p value of .1939, and so we fail to reject the null hypothesis

## MLR.6 Normality

$\sigma^2:u \sim Normal(0,\sigma^2)$
```{r echo=FALSE, comment=NA}
hist(resid(model), freq =FALSE)
lines(density(resid(model), adjust = 2), lty = "dotted", col="red", lwd=3) 
```

- Normal distribution of our data is shown here. 

# Results {data-transition="slide-in fade-out"}

Buckle Up...

## Regression Results

```{r echo=FALSE, comment=NA}
summary(model)
```
- Initial view of results: only two of our variables are statistically significant!
- $R^2$ is low at 12.22%, while adjusted $R^2$ is also low at 10.71%
- This tells us that the variation in our explanatory variables explain very little of the variation in our explained variable (sleep)
- We shouldn't focus too much on the $R^2$ of the regression, but this could be a sign that other factors we haven't analyzed are affecting sleep.

## Coefficients
```{r echo=FALSE, comment=NA}
summary(model)
```
- On average, in 1975, a one dollar increase in someone's hourly wage is associated with an increase of 0.0104 hours of sleep per week
- Standard error is for hrwage is .0904
- This would equate to, on average, only 37.44 seconds extra sleep per week for a one dollar increase in hourly wage
- Rest of our coefficients show similar results in that they appear to, on average, have a small impact on sleep
- Only exception to this is totwrk and also marr, which we can see are statistically significant at varying significance levels

## F and t statistics
```{r echo=FALSE, comment=NA}
summary(model)
```
- F statistics show us unsurprising results: it is statistically significant
- We ran iterations of our model that weren't even jointly significant, so we made sure to include enough variables to fix this
- T statistics are almost all very small with the exception of totwrk and marr

## Hypothesis Testing
```{r echo=FALSE, comment=NA}
summary(model)
```
$H_0: \beta_1 = 0$
Null Hypothesis is that hourly wage has no effect on the number of hours of sleep someone gets in a week
$H_1: \beta_1 \neq 0$
Alternative Hypothesis is that hourly wage does have an effect on the amount of sleep that someone gets in a week
- with a p-value of .9086, hrwage is only statistically significant as low as the 90.86% significance level
- we fail to reject the Null Hypothesis
- Take note: totwrk and marr are statistically significant

## Confidence Interval
```{r echo=FALSE, comment=NA}
confint(model, level = .95)
```
- There is a 95% probability that the true population mean lies within our confidence interval here
- Unfortunately (but unsurprising, 0 lies within our 95% confidence interval), further providing evidence to reject the null hypothesis

# Conclusion

Does one's hourly wage have some relationship with the amount of sleep that they get in a given week?

## The Downside

Even after exploring multiple potential transformations of our original mode, adding more explanatory variables, and close analysis, our conclusion is that someone's hourly wage has little to no effect on the amount of sleep that someone gets in a given week. Moreover, the only variables that we could conclude had ANY statistically significant effect on sleep were how much someone works in a week and their marital status. We were originally discouraged by these results, as it made us feel like our original research question was a boring one. 

## The Upside

These results, however, raise more interesting questions that call for further investigation. While knowing someone's hourly wage might not help us that much in predicting how much sleep that they get in a week, perhaps the reason for this is that our preferences are more individualistic in a way that cannot be captured simply by how much money that someone makes. Two different CEOs may have wildly different preferences on sleeping, and we could see a similarly commplex situation at lower hourly wages too. So if we can make any conclusion from these results, it's that we need to know MORE. 
